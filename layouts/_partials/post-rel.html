{{ $show := default true (default .Site.Params.ShowRelPost .Params.ShowRelPost) }}
{{ if and $show .IsPage }}
  <hr>
  {{ $page := . }}
  {{ $taxonomyTitles := .Site.Params.taxonomyTitles}}
  {{ range $taxonomyName, $taxonomy := .Site.Taxonomies }}
    {{ $terms := ($page.GetTerms $taxonomyName) }}
    {{ with $terms }}
      <details open>
        {{- $taxonomyTitle := index $taxonomyTitles $taxonomyName | default $taxonomyName }} 
        <summary>{{ $taxonomyTitle }}</summary>
        <ul>
          {{- range . }} 
            <li>
              <details open>
                <summary>
                  <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
                </summary>
                <ul>
                  {{ range .RegularPages }}
                    <li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>
                  {{- end }}
                </ul>
            </details></li>
          {{ end }} 
        </ul>
      </details>
    {{ end }}
  {{ end }}
{{- end}}
