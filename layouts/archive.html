{{ define "nav" }}
  {{ partial "site-info.html" . }}
  {{ partial "file-tree.html" . }} 
{{ end }}

{{ define "main" }}
  <h1>{{ .Title }}</h1>
  <p><a href="/index.xml">rss</a></p>
  {{ .Content }}
  <h2>Taxonomies</h2>
  {{ $taxonomyTitles := .Site.Params.taxonomyTitles}}
  {{- range $taxonomyName, $taxonomy := .Site.Taxonomies }} 
    {{- $taxonomyTitle := index $taxonomyTitles $taxonomyName | default $taxonomyName }} 
    {{- with $taxonomy }}
      <h3><a href="/{{ $taxonomyName }}">{{ $taxonomyTitle }} </a><sup>{{ len $taxonomy }}</sup></h3>
        {{- range $name, $value := $taxonomy }}
          {{- $count := $value.Count }}
          {{- $page := site.GetPage (printf "/%s/%s" $taxonomyName $name) }}
            {{- with $page }}
              <code><a href="{{ .Permalink }}">{{ .Name }}</a><sup>{{ $count }}</sup></code>
            {{- end }}
          {{- end }}
        {{- end }} 
  {{- end }}
  <h2>Search</h2>
  {{ partial "search.html" . }}
  <h2>List of all posts</h2>
  {{ range site.RegularPages }}
    <section style="border: 1px solid #ccc; margin: 10px; padding: 0.5rem;">
      <p><a href="{{ .Permalink }}"><b>{{ .Title }}</b></a> <small>{{ .Summary | plainify | truncate 50 | strings.TrimSpace }}</small></p>
      <p>
        {{ with .Date }}
          {{ $dateMachine := .Format "2006-01-02T15:04:05-07:00" }}
          <time datetime="{{ $dateMachine }}">{{ .Format "2006/01/02" }}</time>
        {{ end }}
        <span>{{ .WordCount  }}字 {{ .ReadingTime  }}分钟</span>
        {{ $cc := (default "nc-sa" (default .Site.Params.copyright .Params.copyright)) }}
        {{ with .Params.status }}
          <i>{{ . }}</i>
        {{ end }}
      </p>
    </section>
  {{ end }}
{{ end }}
